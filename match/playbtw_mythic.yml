# espanso match file
# Author: JeansenVaars
# Consider inviting me a Coffee, this took quite some work! -> https://ko-fi.com/JeansenVaars
# Check out my Blog -> https://jvhouse.xyz/
# USE AT YOUR OWN RISK

matches:
  # Mythic Fate check. Based on Variations 2, e.g. :fatecheck - https://www.drivethrurpg.com/product/20798/Mythic-Game-Master-Emulator
  - trigger: ":mmfc"
    replace: "{{output}}"
    vars:
      - name: fcparams
        type: form
        params:
          layout: |
            Modifier [[odd]] Chaos [[cf]]
          fields:
            odd:
              type: list
              values:
                - "-5"
                - "-4"
                - "-2"
                - "-1"
                - "0"
                - "+1"
                - "+2"
                - "+4"
                - "+5"
            cf:
              type: list
              values:
                - "1"
                - "2"
                - "3"
                - "4"
                - "5"
                - "6"
                - "7"
                - "8"
                - "9"
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_mythic"
            - fate_check
            - --odds
            - "{{fcparams.odd}}"
            - --chaos
            - "{{fcparams.cf}}"
  # Mythic FAST fate check
  # Use with modifier and chaos for example :mfc-2c5
  - regex: ":mfc(?P<odds>[-+]?\\d)c(?P<chaos>\\d)"
    replace: "{{output}}"
    vars:
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_mythic"
            - fate_check
            - --odds
            - "{{odds}}"
            - --chaos
            - "{{chaos}}"
  # Mythic Scene Check for example :msc7
  - regex: ":malt(?P<chaos>\\d)"
    replace: "{{output}}"
    vars:
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_mythic"
            - scene_check
            - --chaos
            - "{{chaos}}"
  # Mythic default Focus
  - trigger: ":mfoc"
    replace: "{{output}}"
    vars:
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - wtable
            - --table
            - mythic_focus
  # Mythic adventure Focus
  - trigger: ":madfoc"
    replace: "{{output}}"
    vars:
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - wtable
            - --table
            - mythic_focus_adv
  # Mythic Focus with custom table. Table name between dots. Without the extension. Must be .psv
  - regex: ":mfo\\.(?P<table>.*)\\."
    replace: "({{table}}): {{output}}"
    vars:
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - wtable
            - --table
            - "{{table}}"
  # Mythic Random Event
  - trigger: ":mre"
    replace: "{{output}}"
    vars:
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_mythic"
            - random_event
  # Mythic Action descriptor. Without Focus.
  - trigger: ":mac"
    replace: "{{output}}"
    vars:
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - table
            - --table
            - mythic_action_1,mythic_action_2
  # Mythic Description descriptor.
  - trigger: ":mde"
    replace: "{{output}}"
    vars:
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - table
            - --table
            - mythic_description_1,mythic_description_2
  # Mythic characters lists
  - trigger: ":mchars"
    replace: "{{output}}"
    vars:
      - name: entries
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - load_utable
            - --table
            - "mythic_charlist"
            - --contains
            - "1-2 CHOOSE\n3-4 CHOOSE\n5-6 CHOOSE\n7-8 CHOOSE\n9-10 CHOOSE\n"
      - name: form1
        type: form
        params:
          layout: |
            Mythic Characters List:
            [[file1]]
          fields:
            file1:
              type: text
              multiline: true
              default: "{{entries}}"
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - save_utable
            - --table
            - "mythic_charlist"
            - --contains
            - "{{form1.file1}}"
  - trigger: ":mcharr"
    replace: "{{output}}"
    vars:
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - utable
            - --table
            - "mythic_charlist"
  # Mythic threads lists
  - trigger: ":mthreads"
    replace: "{{output}}"
    vars:
      - name: entries
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - load_utable
            - --table
            - "mythic_threadlist"
            - --contains
            - "1-2 CHOOSE\n3-4 CHOOSE\n5-6 CHOOSE\n7-8 CHOOSE\n9-10 CHOOSE\n"
      - name: form1
        type: form
        params:
          layout: |
            Mythic Threads List:
            [[file1]]
          fields:
            file1:
              type: text
              multiline: true
              default: "{{entries}}"
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - save_utable
            - --table
            - "mythic_threadlist"
            - --contains
            - "{{form1.file1}}"
  - trigger: ":mthreadr"
    replace: "{{output}}"
    vars:
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - utable
            - --table
            - "mythic_threadlist"
  # Mythic adventure features lists
  - trigger: ":mfeatures"
    replace: "{{output}}"
    vars:
      - name: entries
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - load_utable
            - --table
            - "mythic_featurelist"
            - --contains
            - "1-2 CHOOSE\n3-4 CHOOSE\n5-6 CHOOSE\n7-8 CHOOSE\n9-10 CHOOSE\n"
      - name: form1
        type: form
        params:
          layout: |
            Mythic Adventure Features List:
            [[file1]]
          fields:
            file1:
              type: text
              multiline: true
              default: "{{entries}}"
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - save_utable
            - --table
            - "mythic_featurelist"
            - --contains
            - "{{form1.file1}}"
  - trigger: ":mfeaturer"
    replace: "{{output}}"
    vars:
      - name: output
        type: script
        params:
          args:
            - "%CONFIG%/scripts/playbtw_core"
            - utable
            - --table
            - "mythic_featurelist"